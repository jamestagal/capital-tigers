!function(e){"use strict";function s(e,t){return e+".touchspin_"+t}function n(t,n){return e.map(t,function(e){return s(e,n)})}var t=0;e.fn.TouchSpin=function(s){if("destroy"===s)return void this.each(function(){var t=e(this),s=t.data();e(document).off(n(["mouseup","touchend","touchcancel","mousemove","touchmove","scroll","scrollstart"],s.spinnerid).join(" "))});var o={min:0,max:100,initval:"",replacementval:"",step:1,decimals:0,stepinterval:100,forcestepdivisibility:"round",stepintervaldelay:500,verticalbuttons:!1,verticalupclass:"fa fa-angle-up",verticaldownclass:"fa fa-angle-down",prefix:"",postfix:"",prefix_extraclass:"",postfix_extraclass:"",booster:!0,boostat:10,maxboostedstep:!1,mousewheel:!0,buttondown_class:"btn btn-default",buttonup_class:"btn btn-default",buttondown_txt:"-",buttonup_txt:"+"},i={min:"min",max:"max",initval:"init-val",replacementval:"replacement-val",step:"step",decimals:"decimals",stepinterval:"step-interval",verticalbuttons:"vertical-buttons",verticalupclass:"vertical-up-class",verticaldownclass:"vertical-down-class",forcestepdivisibility:"force-step-divisibility",stepintervaldelay:"step-interval-delay",prefix:"prefix",postfix:"postfix",prefix_extraclass:"prefix-extra-class",postfix_extraclass:"postfix-extra-class",booster:"booster",boostat:"boostat",maxboostedstep:"max-boosted-step",mousewheel:"mouse-wheel",buttondown_class:"button-down-class",buttonup_class:"button-up-class",buttondown_txt:"button-down-txt",buttonup_txt:"button-up-txt"};return this.each(function(){function D(){if(!r.data("alreadyinitialized")){if(r.data("alreadyinitialized",!0),t+=1,r.data("spinnerid",t),!r.is("input"))return void console.log("Must be an input.");M(),P(),g(),k(),R(),F(),C(),z(),c.input.css("display","block")}}function P(){""!==a.initval&&""===r.val()&&r.val(a.initval)}function N(e){x(e),g();var t=c.input.val();""!==t&&(t=Number(c.input.val()),c.input.val(t.toFixed(a.decimals)))}function M(){a=e.extend({},o,L,S(),s)}function S(){var t={};return e.each(i,function(e,n){var s="bts-"+n;r.is("[data-"+s+"]")&&(t[e]=r.data(s))}),t}function x(t){a=e.extend({},a,t)}function k(){var e=r.val(),t=r.parent();""!==e&&(e=Number(e).toFixed(a.decimals)),r.data("initvalue",e).val(e),r.addClass("form-control"),t.hasClass("input-group")?E(t):T()}function E(t){t.addClass("bootstrap-touchspin");var n,s,o=r.prev(),i=r.next(),c='<span class="input-group-addon bootstrap-touchspin-prefix">'+a.prefix+"</span>",l='<span class="input-group-addon bootstrap-touchspin-postfix">'+a.postfix+"</span>";o.hasClass("input-group-btn")?(n='<button class="'+a.buttondown_class+' bootstrap-touchspin-down" type="button">'+a.buttondown_txt+"</button>",o.append(n)):(n='<span class="input-group-btn"><button class="'+a.buttondown_class+' bootstrap-touchspin-down" type="button">'+a.buttondown_txt+"</button></span>",e(n).insertBefore(r)),i.hasClass("input-group-btn")?(s='<button class="'+a.buttonup_class+' bootstrap-touchspin-up" type="button">'+a.buttonup_txt+"</button>",i.prepend(s)):(s='<span class="input-group-btn"><button class="'+a.buttonup_class+' bootstrap-touchspin-up" type="button">'+a.buttonup_txt+"</button></span>",e(s).insertAfter(r)),e(c).insertBefore(r),e(l).insertAfter(r),h=t}function T(){var t=a.verticalbuttons?'<div class="input-group bootstrap-touchspin"><span class="input-group-addon bootstrap-touchspin-prefix">'+a.prefix+'</span><span class="input-group-addon bootstrap-touchspin-postfix">'+a.postfix+'</span><span class="input-group-btn-vertical"><button class="'+a.buttondown_class+' bootstrap-touchspin-up" type="button"><i class="'+a.verticalupclass+'"></i></button><button class="'+a.buttonup_class+' bootstrap-touchspin-down" type="button"><i class="'+a.verticaldownclass+'"></i></button></span></div>':'<div class="input-group bootstrap-touchspin"><span class="input-group-btn"><button class="'+a.buttondown_class+' bootstrap-touchspin-down" type="button">'+a.buttondown_txt+'</button></span><span class="input-group-addon bootstrap-touchspin-prefix">'+a.prefix+'</span><span class="input-group-addon bootstrap-touchspin-postfix">'+a.postfix+'</span><span class="input-group-btn"><button class="'+a.buttonup_class+' bootstrap-touchspin-up" type="button">'+a.buttonup_txt+"</button></span></div>";h=e(t).insertBefore(r),e(".bootstrap-touchspin-prefix",h).after(r),r.hasClass("input-sm")?h.addClass("input-group-sm"):r.hasClass("input-lg")&&h.addClass("input-group-lg")}function R(){c={down:e(".bootstrap-touchspin-down",h),up:e(".bootstrap-touchspin-up",h),input:e("input",h),prefix:e(".bootstrap-touchspin-prefix",h).addClass(a.prefix_extraclass),postfix:e(".bootstrap-touchspin-postfix",h).addClass(a.postfix_extraclass)}}function F(){""===a.prefix&&c.prefix.hide(),""===a.postfix&&c.postfix.hide()}function C(){r.on("keydown",function(e){var t=e.keyCode||e.which;38===t?("up"!==u&&(m(),v()),e.preventDefault()):40===t&&("down"!==u&&(f(),b()),e.preventDefault())}),r.on("keyup",function(e){var t=e.keyCode||e.which;38===t?d():40===t&&d()}),r.on("blur",function(){g()}),c.down.on("keydown",function(e){var t=e.keyCode||e.which;(32===t||13===t)&&("down"!==u&&(f(),b()),e.preventDefault())}),c.down.on("keyup",function(e){var t=e.keyCode||e.which;(32===t||13===t)&&d()}),c.up.on("keydown",function(e){var t=e.keyCode||e.which;(32===t||13===t)&&("up"!==u&&(m(),v()),e.preventDefault())}),c.up.on("keyup",function(e){var t=e.keyCode||e.which;(32===t||13===t)&&d()}),c.down.on("mousedown.touchspin",function(e){c.down.off("touchstart.touchspin"),r.is(":disabled")||(f(),b(),e.preventDefault(),e.stopPropagation())}),c.down.on("touchstart.touchspin",function(e){c.down.off("mousedown.touchspin"),r.is(":disabled")||(f(),b(),e.preventDefault(),e.stopPropagation())}),c.up.on("mousedown.touchspin",function(e){c.up.off("touchstart.touchspin"),r.is(":disabled")||(m(),v(),e.preventDefault(),e.stopPropagation())}),c.up.on("touchstart.touchspin",function(e){c.up.off("mousedown.touchspin"),r.is(":disabled")||(m(),v(),e.preventDefault(),e.stopPropagation())}),c.up.on("mouseout touchleave touchend touchcancel",function(e){u&&(e.stopPropagation(),d())}),c.down.on("mouseout touchleave touchend touchcancel",function(e){u&&(e.stopPropagation(),d())}),c.down.on("mousemove touchmove",function(e){u&&(e.stopPropagation(),e.preventDefault())}),c.up.on("mousemove touchmove",function(e){u&&(e.stopPropagation(),e.preventDefault())}),e(document).on(n(["mouseup","touchend","touchcancel"],t).join(" "),function(e){u&&(e.preventDefault(),d())}),e(document).on(n(["mousemove","touchmove","scroll","scrollstart"],t).join(" "),function(e){u&&(e.preventDefault(),d())}),r.on("mousewheel DOMMouseScroll",function(e){if(a.mousewheel&&r.is(":focus")){var t=e.originalEvent.wheelDelta||-e.originalEvent.deltaY||-e.originalEvent.detail;e.stopPropagation(),e.preventDefault(),0>t?f():m()}})}function z(){r.on("touchspin.uponce",function(){d(),m()}),r.on("touchspin.downonce",function(){d(),f()}),r.on("touchspin.startupspin",function(){v()}),r.on("touchspin.startdownspin",function(){b()}),r.on("touchspin.stopspin",function(){d()}),r.on("touchspin.updatesettings",function(e,t){N(t)})}function A(e){switch(a.forcestepdivisibility){case"round":return(Math.round(e/a.step)*a.step).toFixed(a.decimals);case"floor":return(Math.floor(e/a.step)*a.step).toFixed(a.decimals);case"ceil":return(Math.ceil(e/a.step)*a.step).toFixed(a.decimals);default:return e}}function g(){var e,t,n;return n=r.val(),""===n?void(""!==a.replacementval&&(r.val(a.replacementval),r.trigger("change"))):void(a.decimals>0&&"."===n||(e=parseFloat(n),isNaN(e)&&(e=""!==a.replacementval?a.replacementval:0),t=e,e.toString()!==n&&(t=e),e<a.min&&(t=a.min),e>a.max&&(t=a.max),t=A(t),Number(n).toString()!==t.toString()&&(r.val(t),r.trigger("change"))))}function _(){if(a.booster){var e=Math.pow(2,Math.floor(p/a.boostat))*a.step;return a.maxboostedstep&&e>a.maxboostedstep&&(e=a.maxboostedstep,l=Math.round(l/e)*e),Math.max(a.step,e)}return a.step}function m(){g(),l=parseFloat(c.input.val()),isNaN(l)&&(l=0);var e=l,t=_();l+=t,l>a.max&&(l=a.max,r.trigger("touchspin.on.max"),d()),c.input.val(Number(l).toFixed(a.decimals)),e!==l&&r.trigger("change")}function f(){g(),l=parseFloat(c.input.val()),isNaN(l)&&(l=0);var e=l,t=_();l-=t,l<a.min&&(l=a.min,r.trigger("touchspin.on.min"),d()),c.input.val(l.toFixed(a.decimals)),e!==l&&r.trigger("change")}function b(){d(),p=0,u="down",r.trigger("touchspin.on.startspin"),r.trigger("touchspin.on.startdownspin"),O=setTimeout(function(){y=setInterval(function(){p++,f()},a.stepinterval)},a.stepintervaldelay)}function v(){d(),p=0,u="up",r.trigger("touchspin.on.startspin"),r.trigger("touchspin.on.startupspin"),w=setTimeout(function(){j=setInterval(function(){p++,m()},a.stepinterval)},a.stepintervaldelay)}function d(){switch(clearTimeout(O),clearTimeout(w),clearInterval(y),clearInterval(j),u){case"up":r.trigger("touchspin.on.stopupspin"),r.trigger("touchspin.on.stopspin");break;case"down":r.trigger("touchspin.on.stopdownspin"),r.trigger("touchspin.on.stopspin")}p=0,u=!1}var a,c,l,h,j,y,w,O,r=e(this),L=r.data(),p=0,u=!1;D()})}}(jQuery)